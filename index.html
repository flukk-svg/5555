<!doctype html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <div class="max-w-4xl mx-auto py-10 px-6">
    <h1 class="text-3xl font-bold text-center mb-8 text-gray-800">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå</h1>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
    <form id="equipment-form" class="bg-white p-6 rounded-xl shadow-md space-y-4">
      <div>
        <label class="block mb-2 text-sm font-medium">‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</label>
        <input type="text" id="equipment-name" class="w-full border rounded-lg p-2" required />
      </div>

      <div>
        <label class="block mb-2 text-sm font-medium">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</label>
        <select id="equipment-type" class="w-full border rounded-lg p-2" required>
          <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
          <option>Desktop</option>
          <option>Laptop</option>
          <option>Monitor</option>
          <option>Printer</option>
          <option>Server</option>
          <option>Network</option>
          <option>Other</option>
        </select>
      </div>

      <div>
        <label class="block mb-2 text-sm font-medium">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
        <input type="text" id="user-name" class="w-full border rounded-lg p-2" required />
      </div>

      <div>
        <label class="block mb-2 text-sm font-medium">‡πÅ‡∏ú‡∏ô‡∏Å</label>
        <input type="text" id="department" class="w-full border rounded-lg p-2" required />
      </div>

      <div>
        <label class="block mb-2 text-sm font-medium">Serial Number</label>
        <input type="text" id="serial-number" class="w-full border rounded-lg p-2" required />
      </div>

      <div>
        <label class="block mb-2 text-sm font-medium">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</label>
        <input type="file" id="equipment-image" accept="image/*" />
        <img id="image-preview" class="mt-3 w-48 hidden rounded-lg shadow" />
      </div>

      <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700">
        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
      </button>
    </form>

    <p id="result-message" class="mt-4 text-center font-medium"></p>
  </div>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyolBLsBNz8CrwnUv5oQTnkat3vgeM1UONliw5qX2dwquCH1T1iBgsGreFVeqHg1QddPQ/exec"; // üëà ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

    document.getElementById("equipment-image").addEventListener("change", (e) => {
      const file = e.target.files[0];
      const preview = document.getElementById("image-preview");
      if (file) {
        const reader = new FileReader();
        reader.onload = (ev) => {
          preview.src = ev.target.result;
          preview.classList.remove("hidden");
        };
        reader.readAsDataURL(file);
      } else {
        preview.classList.add("hidden");
      }
    });

    document.getElementById("equipment-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const result = document.getElementById("result-message");
      result.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

      const imageFile = document.getElementById("equipment-image").files[0];
      let base64Image = "";
      if (imageFile) base64Image = await fileToBase64(imageFile);

      const data = {
        equipment_name: document.getElementById("equipment-name").value,
        equipment_type: document.getElementById("equipment-type").value,
        user_name: document.getElementById("user-name").value,
        department: document.getElementById("department").value,
        serial_number: document.getElementById("serial-number").value,
        image_data: base64Image
      };

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" },
        });
        const json = await res.json();

        if (json.success) {
          result.textContent = "‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!";
          e.target.reset();
          document.getElementById("image-preview").classList.add("hidden");
        } else {
          result.textContent = "‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (json.error || "‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏");
        }
      } catch (err) {
        result.textContent = "‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û
